name: Refresh Predict ELO

on:
  workflow_dispatch:

jobs:
  predict-elo:
    runs-on: ubuntu-latest
    steps:
      - name: POST /admin/predict_elo
        run: |
          curl -X POST "$API_BASE/admin/predict_elo" \
            -H "accept: application/json" \
            -H "x-admin-token: $ADMIN_TOKEN" \
            -H "Content-Type: application/json" \
            -d "$ELO_PRED_JSON"
        env:
          API_BASE: https://ia-sport.onrender.com
          ADMIN_TOKEN: ${{ secrets.ADMIN_TOKEN }}
          # Exemple:
          # {"date":"2025-10-29","league_id":"L1","version":"elo-v1","matches":[{"home":"PSG","away":"OM"},{"home":"Lyon","away":"Monaco"},{"home":"Lille","away":"Rennes"}]}
          ELO_PRED_JSON: ${{ secrets.ELO_PRED_JSON }}
